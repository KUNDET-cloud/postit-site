<!DOCTYPE html>
<html lang="en">
  <head>
    <%- include("partials/head.ejs") %>
      <title>
        <%= title %>
      </title>
  </head>
  <body>
    <%- include("partials/header.ejs") %>

    <main class="container">


      <div class="content">

          <div class="post_view">
            <div class="post_view_info">
              <div class="post_view_author"><%= post.author %></div>
              <div class="post_view_date"><%= post.createdAt.toLocaleDateString() %></div>
            </div>
            <div class="post_view_title"><%= post.title %></div>
            <div class="post_view_text"><%= post.text %></div>
            <div class="buttons">
              <button data-id='<%= post.id %>' class="delete">Delete</button>
            </div>
          </div>

      </div>

    </main>

    <footer class="footer"></footer>
    <script>
      const deleteBtn = document.querySelector(".delete");

      deleteBtn.addEventListener("click", (e) => {
        const id = e.target?.dataset?.id
        if (id) {
          fetch(`/posts/${id}`, {
            method: 'DELETE'
          }).then(() => {
            window.location.href = '/posts'
          })
        }
      });

    </script>
  </body>

</html>